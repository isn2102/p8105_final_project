---
title: "Community Gardens Map"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)

library(tidyverse)
library(plotly)
library(leaflet)
library(ggridges)

#Set global theme for plots
theme_set(theme_minimal() + 
            theme(legend.position = "bottom", 
                  axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)))
#Set options for all plots
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


```{r}
garden =
  read_csv("./data/final_df.csv") %>%
  drop_na(garden_name) %>% 
  group_by(community_board) %>%
  select(community_board, borough, overall_pop, race_white:college_higher, garden_name:longitude)

garden_num = 
  garden %>% 
  drop_na(garden_name) %>% 
  group_by(community_board) %>% 
  summarize(garden_num = n())

garden_tidy = 
  left_join(garden, garden_num, by = "community_board")

```

Column {.sidebar}
-----------------------------------------------------------------------

```{r}

```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}
pal <- colorNumeric(
  palette = "viridis",
  domain = garden_tidy$garden_num)

garden_tidy %>%
   mutate(
    click_label =
      str_c("<b>", garden_name), "</b><br>", garden_num) %>% 
  leaflet() %>%
  addProviderTiles(providers$CartoDB.Positron) %>% 
  addCircleMarkers(~longitude, ~latitude, radius = 1, color = ~pal(garden_num), popup = ~click_label)
```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```